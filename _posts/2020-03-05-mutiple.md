---
title: 다중 선형회귀 정리
categories: 데이터분석
author_profile: true
---

### 다중선형 회귀 분석(변수가 여러개인 경우)

**X와Y가 선형관계 있을때 하는 분석이 다중 선형회귀 분석이다!**

> - 단순선형회귀: 변수가 한개인경우
$\widehat{Y} = B_0 + \widehat{B_1}x$
> - 다중 선형회귀: 변수가 여러개 인 경우
$$\widehat{Y}= \widehat{B_0}+ \widehat{B_1}x_1+ \widehat{B_2}x_2+\widehat{B_3}x_3+....\widehat{B_n}x_n$$

### 다중 선형회귀 추정
**회기계수 추정하는것은 단순선형 회귀 분석과 동일하게 SSE를 최소화 하는 방향으로 동일하다.**
$$SSE = \sum_{i=1}^Ne_i^2=e_1^2+e_2^2+e_3^2...e_n^2$$
**위식을 각각 변수에 대해 편미분을 하여 회귀 계수를 추정!**


---
### 다중선형 회귀계수 해석법
EX) 광고미디어에  다중선형 회귀를 적용하면 다음과 같다. 
> - 신문광고인경우 단순선형회귀에서는 출력변수인 매출과 연관있지만, 다중선형 회귀에서는 P-value가 0.86으로 높아 매출에 유의미한 영향을 미치지못함
신문광고인 단순선형회귀에서 TV광고와 라디오광고의 영향력을 무시했기에 생긴 결과

||Coefficient|Std.error|L-static|p-value|
|---|---|---|---|---|
|internet|2.939|0.3119|9.424|	<0.0001|
|TV|0.046|0.0014|	32.81|	0.0001|
|radio|0.189|0.0086|	21.89|	0.0001|
|newspaper|-0.0001|0.0059|	-0.18|	0.8599|


**Cofficient(회귀계수)** $B_1$~~~$B_n$값들


**단순선형와 달라진점은 앞에조건이 붙는다는것 radio와newspaper 다른변수들은 고정되어있을때 Tv가 1단위가 증가할때 Y는 0.046 단위가 증가한다.**

>**회귀 계수가 0 에 가까워지거나 표준오차가 굉장히 커지면 t-statistic이 0에가까워지고 결국 p-value는 높아진다.**


위에 있는 표를 보면 newspaper를보면 회귀계수도 0에 가까워졌고 p-value는 엄청크다. 그렇다면 왜 이런현상이 일어났을까??

**TV,Radio, newspaper 서로 상관솬계가 크고, 이때 역행렬이 구해지지않아서 생기기때문이다.**



> - **다중선형회귀계수를 해석하는방법: 다른변수가 고정되어있을때, TV가 1단위 증가할때, Y 즉, 매출액은 0.046단위로 증가한다. 그때 p-value는 작기때문에 유의미한 변수로 볼 수 있다 라고 해석한다.**

---

### 다중선형 회귀모델 검정

**다중선형 분석에서는 각각의 선형회귀계수들이 유의미한지와 별개로 이 모델이 의미있는지 없는지에 대해서도 결정해야한다.**

#### F-검정을 통해서 검정

$$F= {{V_1/k_1\over V_2/k_2}} ~~~F(k_1,k_2)$$

**두 확률변수 $v_1$,$v_2$가 서로 독립인 카이제곱 분포를 따른다고 할때, 확률변수F는 F분포를 따른다. F검정과 분산분석등에서 주로 사용된다.**

---


<img src="/assets/images/b1.png">


$R^2 = {SSR\over SST}$ 변수들이 SSR에 들어오면 자연스럽게 커지게 된다. 변수가 증가하면 증가할 수록 F검정과 $R^2$을 통한 결과가 사실 큰의미를 가지지 않을 수도 있다. **결국에는 F검정결과와 $R^2$결과를 꼭 신뢰 할 수는 없다.** 특히, 변수가 많아질때, 변수가 적을때는 $R^2$와 F통계량에 대한 검정 결과가 어느정도 유의미하다 라고 할 수는 있지만, 변수가 증가 했을때 변수가 매우 많을때 그 결과를 신뢰 할 수 없다. 왜냐하면 **변수가 많을때는 다중 공선성이 발생하기때문** 

다중 공선성이 발생하면 $R^2$도 커지고 F통계량도 커져서 p-value가 낮아지는 경향이 보일수 있다.


---

### 다중 공선성(Multicollinearity)
- **독립변수들이 강한 선형관계에 있을때, 다중공선성이 있다고한다.**

<img src="/assets/images/b3.png">





**그림을보면,  각각 매출을 설명하는 radio, newspaper, tv가 있는데 이들끼리 겹치는 부분이 있다. y의 변동은 정해져있는데 x가 y을 설명하는 그 변동성이 얼마나 잘 설명하느냐가 중요한데 변수가 여러개 일때는 이 변동성이 겹칠수 있다. 이 겹치는 부분에 대해서는 각각의 변수들이 중복으로 가져갈 수 없다. 그러다 보니까 특정 변수는 하나만들어가면 100% 다 가져가는데 같이들어가니까 80%만 가져가게 되는것이다 그래서, 자연스럽게 회귀계수가 낮게 추정 되는것이다. 이러한 현상이 다중공선성이다.**

다시말해서, **Tv, radio, newspaper 각각의 독립변수들이 선형관계가 강하다 보니까 이 y의 매출을 설명하는 변동성이 겹치기 때문에 이러한 현상이 발생하는거다.**



### 그러다보니 잘못된 변수 해석을 하고, 예측 정확도도 떨어진다.


---
### 다중 공선성 진단하는 방법

#### VIF(Variance Information Factor)
**변수들간의 Correlation으로 진단**

> - **Correlation:**
 변수들간의 선형관계가 있다는것은 그만큼 correlation이 높게 나온다 그래서, 이 correlation을 보고 특정변수가 다른 변수들과 correlation이 심하다면 그 변수를 제거하고 다시 회귀를 적합 시킨다.

 $$VIF_i = {1\over 1- R_i^2}$$

---

### 다중공선성을 해결하는 방법 

- **Feature Selection: 중요 변수만 선택하는 방법**
   - 단순 변수를 제거하는방법(correlation 지표를 보고난 뒤 제거)
   - Lasso
   - stepwise
   -기타 변수 선택 알고리즘
- **변수를 줄이지 않고 활용하는 법**
- Auto-Encoder등 Feature Extraction 기법
- PCA
- Ridge

### 중요한건, 중요 feature(변수)를 뽑는 방법은 데이터 사이언스 에서도 현재까지 큰 이슈


**정석적인 방법은 없다**
